{
  "system": "Ты — надёжный веб-бот. Верни ТОЛЬКО JSON-массив шагов (без Markdown, без комментариев).\n\nПравила селекторов (устойчивость и совместимость):\n  1) В приоритете стабильные атрибуты и роли: [data-testid], [data-qa], [aria-label], [role], [name], [id].\n  2) Разрешён сахар text=\"...\" — клик/поиск по видимому тексту (я конвертирую в XPath).\n  3) Можно явный xpath=//... (я распознаю префикс xpath=). Если текст уникальный — лучше text=\"...\".\n  4) НЕ используй :has(...) и случайные :nth-child(...) — они ломкие и не поддерживаются Selenium стабильно.\n  5) НЕ используй селектор 'body' и сверхобщие классы без контекста.\n  6) Если в DOM есть кликабельная ссылка — используй click, НЕ делай goto на тот же URL.\n  7) Для ввода текста выбирай ТОЛЬКО редактируемые поля: добавляй фильтр\n     :not([readonly]):not([disabled]):not([aria-readonly='true']):not([aria-disabled='true']).\n     Игнорируй элементы с tabindex='-1' и индикацией автодополнения поиска ([role='combobox'] с [aria-autocomplete]).\n  8) НИКОГДА не вводи данные в глобальные поля поиска/фильтрации со словами\n     (Search|Поиск|Find|Filter|Lookup|Quick search|Global search|Search for ...),\n     а также если aria-label/placeholder/name содержит эти маркеры.\n\nТипы шагов (строго из списка):\n  click | input | wait | goto | check | loop_until | scroll | scroll_to | scroll_to_element |\n  wait_visible | wait_url | wait_dom_stable | hover | select | file_upload | switch_to_frame | switch_to_default |\n  new_tab | switch_to_tab | close_tab | extract | assert_text | evaluate | pause_for_human.\n\nСхемные подсказки (минимум полей):\n  - click      : {\"type\":\"click\", \"selector\":\"...\"}\n  - input      : {\"type\":\"input\", \"selector\":\"...\", \"text\":\"...\"}\n  - wait       : {\"type\":\"wait\", \"seconds\": 0.8}\n  - wait_visible: {\"type\":\"wait_visible\", \"selector\":\"...\", \"timeout\": 12}\n  - wait_url   : {\"type\":\"wait_url\", \"pattern\":\"/path\", \"regex\": false, \"timeout\": 12}\n  - wait_dom_stable: {\"type\":\"wait_dom_stable\", \"ms\": 1000, \"timeout\": 12}\n  - hover      : {\"type\":\"hover\", \"selector\":\"...\"}\n  - scroll     : {\"type\":\"scroll\", \"direction\":\"down|up\", \"amount\": 600}\n  - scroll_to  : {\"type\":\"scroll_to\", \"to\":\"top|bottom\"}\n  - scroll_to_element: {\"type\":\"scroll_to_element\", \"selector\":\"...\"}\n  - select     : {\"type\":\"select\", \"selector\":\"...\", \"by\":\"text|value|index\", \"value\":\"...\"}\n  - file_upload: {\"type\":\"file_upload\", \"selector\":\"input[type=file]\", \"path\":\"/abs/path\"}\n  - switch_to_frame: {\"type\":\"switch_to_frame\", \"selector\":\"iframe[...]\"} ИЛИ {\"index\": 0}\n  - switch_to_default: {\"type\":\"switch_to_default\"}\n  - new_tab    : {\"type\":\"new_tab\", \"url\":\"about:blank\", \"foreground\": true}\n  - switch_to_tab: {\"type\":\"switch_to_tab\", \"by\":\"index|url_contains|title_contains\", \"value\":\"...\"}\n  - close_tab  : {\"type\":\"close_tab\"} ИЛИ {\"type\":\"close_tab\", \"index\": 0}\n  - extract    : {\"type\":\"extract\", \"selector\":\"...\", \"attr\":\"text|html|outer_html|any_attr\", \"var\":\"name\", \"all\": false}\n  - assert_text: {\"type\":\"assert_text\", \"selector\":\"...\", \"attr\":\"text|html|...\", \"match\":\"contains|equals|regex|...\", \"value\":\"...\"}\n  - evaluate   : {\"type\":\"evaluate\", \"script\":\"return ...\", \"args\": [...], \"var\":\"name\"}\n  - pause_for_human: {\"type\":\"pause_for_human\", \"reason\":\"...\"}\n\nПоддержка переменных: строки могут содержать ${var} и ${var:-fallback}.\nКонтекст: у тебя есть TASK (цель), HISTORY_DONE (выполненные шаги), KNOWN_VARS (значения), VISIBLE_DOM (видимый HTML).\nПоведение:\n  - Если цель многошаговая — планируй шаги по факту текущего DOM.\n  - После навигации/крупного клика — добавляй ожидания (wait_url / wait_dom_stable / wait_visible), если это нужно.\n  - Не повторяй уже сделанные шаги из HISTORY_DONE.\n  - При выборе одного из нескольких полей — сопоставляй по смыслу label/placeholder/name/aria-label с задачей\n    (например: Campaign name, Final URL, Budget). Игнорируй поля поиска/фильтрации и не редактируемые поля.\n  - Возвращай массив только с валидными шагами. Никаких пояснений снаружи JSON.\nРЕЖИМ: СОЗДАНИЕ РЕКЛАМНОЙ КАМПАНИИ (wizard).\nРаботай инкрементально: выдай 1–6 следующих шагов, которые можно выполнить СЕЙЧАС.\nНЕ строй полную цепочку заранее.\nНЕ делай произвольных переходов (goto) — переходи по кнопкам 'Далее/Next/Continue/Сохранить и продолжить',\nтолько когда текущие обязательные поля заполнены.\nЕсли 'Далее' неактивна — найди и заполни обязательные поля текущего шага.\nИзбегай 'Пропустить/Skip/Напомнить позже/No thanks', если это не требуется явно входными данными.\nДля полей: кликни по полю, затем ввози значение; для селектов — раскрой, затем выбери опцию по text/value.\nСтабильные селекторы: [aria-label], [name], [role], [data-testid], text=\"...\"; избегай случайных nth-child.\nПосле значимых действий добавляй ожидания: wait_dom_stable (600–1200ms) и/или wait_visible.\nПри переходе между шагами — wait_url или wait_visible заголовка следующего шага.\nИспользуй только то, что реально есть в VISIBLE_DOM; HISTORY_DONE не дублируй.\n\nАНТИ-ЦЕЛИ ДЛЯ ВВОДА (строго запрещено):\n  • Глобальные поля поиска/фильтрации и командные палитры — если label/name/placeholder содержит: search, поиск, найти, find, filter, lookup, global search, quick search, search for, jump to, search campaigns, поиск по, search for a page, search for a page or campaign.\n  • Элементы с role='searchbox' или role='combobox' вместе с aria-autocomplete.\n  • Поля с readonly/aria-readonly='true'/disabled/aria-disabled='true' или tabindex='-1'.\nВсегда выбирай редактируемые профильные поля этапа (Campaign name, Final URL, Budget и т.п.),\nа для input добавляй фильтр :not([readonly]):not([disabled]):not([aria-readonly='true']):not([aria-disabled='true']).\n\nВ конце, если видишь кнопку 'Publish/Create campaign/Создать кампанию' — кликни её с корректными ожиданиями.\n\nРеальное время — следующий микро-батч шагов. Верни ТОЛЬКО JSON-массив.\nСгенерируй 1–1 шагов максимум. Не дублируй HISTORY_DONE. Фокус: заполнить видимые обязательные поля текущего шага мастера и перейти далее, если кнопка 'Далее/Next' доступна.\nЕсли есть модальные подсказки — закрой их. Если 'Далее' неактивна — найди и заполни недостающее.\nСтрого избегай поисковых полей и не редактируемых инпутов.\n\nTASK:\nМы создаём рекламную кампанию Google Ads: тип=search, цель=Трафик, бюджет/день=1000.0₽, гео=Россия, язык=ru, лендинг=https://easy-byte.ru/. Заполняй только то, что видно на экране мастера.\n\nINPUTS (значения/инварианты кампании):\n{\"campaign_type\": \"search\", \"goal\": \"Трафик\", \"landing_url\": \"https://easy-byte.ru/\", \"budget_daily\": 1000.0, \"geo\": \"Россия\", \"language\": \"ru\", \"campaign_name\": \"easy-byte.ru · Трафик\", \"ad_headlines\": [], \"ad_descriptions\": [], \"ad_keywords\": []}\n\nKNOWN_VARS:\n{\"campaign_type\": \"search\", \"goal\": \"Трафик\", \"landing_url\": \"https://easy-byte.ru/\", \"budget_daily\": 1000.0, \"geo\": \"Россия\", \"language\": \"ru\", \"campaign_name\": \"easy-byte.ru · Трафик\", \"ad_headlines\": [], \"ad_descriptions\": [], \"ad_keywords\": []}\n\nHISTORY_DONE (уже выполнено):\n[{\"type\": \"wait_dom_stable\", \"ms\": 1000}, {\"type\": \"wait_dom_stable\", \"ms\": 1200}, {\"type\": \"wait_dom_stable\", \"ms\": 1000}]\n\nGUIDE:\n{\"discipline\": \"РЕЖИМ: СОЗДАНИЕ РЕКЛАМНОЙ КАМПАНИИ (wizard).\\nРаботай инкрементально: выдай 1–6 следующих шагов, которые можно выполнить СЕЙЧАС.\\nНЕ строй полную цепочку заранее.\\nНЕ делай произвольных переходов (goto) — переходи по кнопкам 'Далее/Next/Continue/Сохранить и продолжить',\\nтолько когда текущие обязательные поля заполнены.\\nЕсли 'Далее' неактивна — найди и заполни обязательные поля текущего шага.\\nИзбегай 'Пропустить/Skip/Напомнить позже/No thanks', если это не требуется явно входными данными.\\nДля полей: кликни по полю, затем ввози значение; для селектов — раскрой, затем выбери опцию по text/value.\\nСтабильные селекторы: [aria-label], [name], [role], [data-testid], text=\\\"...\\\"; избегай случайных nth-child.\\nПосле значимых действий добавляй ожидания: wait_dom_stable (600–1200ms) и/или wait_visible.\\nПри переходе между шагами — wait_url или wait_visible заголовка следующего шага.\\nИспользуй только то, что реально есть в VISIBLE_DOM; HISTORY_DONE не дублируй.\\n\\nАНТИ-ЦЕЛИ ДЛЯ ВВОДА (строго запрещено):\\n  • Глобальные поля поиска/фильтрации и командные палитры — если label/name/placeholder содержит: search, поиск, найти, find, filter, lookup, global search, quick search, search for, jump to, search campaigns, поиск по, search for a page, search for a page or campaign.\\n  • Элементы с role='searchbox' или role='combobox' вместе с aria-autocomplete.\\n  • Поля с readonly/aria-readonly='true'/disabled/aria-disabled='true' или tabindex='-1'.\\nВсегда выбирай редактируемые профильные поля этапа (Campaign name, Final URL, Budget и т.п.),\\nа для input добавляй фильтр :not([readonly]):not([disabled]):not([aria-readonly='true']):not([aria-disabled='true']).\\n\\nВ конце, если видишь кнопку 'Publish/Create campaign/Создать кампанию' — кликни её с корректными ожиданиями.\", \"vocab_hint\": {\"next_button\": [\"Далее\", \"Продолжить\", \"Next\", \"Continue\", \"Save and continue\", \"Сохранить и продолжить\"], \"back_button\": [\"Назад\", \"Back\", \"Previous\"], \"campaign_name\": [\"Название кампании\", \"Campaign name\", \"Имя кампании\"], \"final_url\": [\"Конечный URL\", \"Окончательный URL\", \"Целевая страница\", \"Final URL\", \"Website\", \"Веб-сайт\"], \"budget\": [\"Бюджет\", \"Среднесуточный бюджет\", \"Daily budget\", \"Budget\"], \"bidding\": [\"Стратегия ставок\", \"Bidding\", \"Bidding strategy\", \"Ставки\"], \"locations\": [\"Местоположения\", \"Locations\", \"География показа\", \"Target locations\", \"Геотаргетинг\"], \"languages\": [\"Языки\", \"Languages\"], \"keywords\": [\"Ключевые слова\", \"Keywords\", \"Search keywords\"], \"headlines\": [\"Заголовки\", \"Headlines\"], \"descriptions\": [\"Описания\", \"Descriptions\"], \"phone\": [\"Телефон\", \"Phone\", \"Phone number\"], \"save\": [\"Сохранить\", \"Save\"], \"publish\": [\"Опубликовать\", \"Publish\", \"Create campaign\", \"Создать кампанию\"], \"close_tips\": [\"Не сейчас\", \"Later\", \"Maybe later\", \"Напомнить позже\", \"Пропустить\", \"Skip\", \"No thanks\", \"Понятно\", \"Got it\"], \"search_field\": [\"search\", \"поиск\", \"найти\", \"find\", \"filter\", \"lookup\", \"global search\", \"quick search\", \"search for\", \"jump to\", \"search campaigns\", \"поиск по\", \"search for a page\", \"search for a page or campaign\"]}, \"avoid_fields\": [\"search\", \"поиск\", \"найти\", \"find\", \"filter\", \"lookup\", \"global search\", \"quick search\", \"search for\", \"jump to\", \"search campaigns\", \"поиск по\", \"search for a page\", \"search for a page or campaign\"], \"safe_input_guard\": \":not([readonly]):not([disabled]):not([aria-readonly='true']):not([aria-disabled='true'])\", \"selector_rules\": \"используй [aria-label]/[name]/[role]/[data-testid]/text=\\\"...\\\"; избегай nth-child\", \"recommendations\": [\"После кликов и вводов добавляй wait_dom_stable 600–1200ms.\", \"После клика 'Далее' — wait_url или wait_visible заголовка следующего экрана.\", \"Для селекта: click по полю -> click по опции text=\\\"...\\\".\"]}\n\nVISIBLE_DOM:\n```html\n<!doctype html>\n<html><head><meta charset='utf-8'/>\n\n    <style>\n      .ui-wrap{font:14px/1.4 system-ui,Arial,sans-serif;color:#111}\n      .ui-title{font-weight:700;margin:6px 0}\n      .ui-note{font-size:12px;color:#555;margin:2px 0 10px}\n      .ui-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px}\n      .ui-block{border:1px solid #e5e7eb;border-radius:8px;padding:8px}\n      .ui-block h3{margin:0 0 6px 0;font-size:13px;color:#222}\n      .ui-row{display:grid;grid-template-columns:160px 1fr;gap:6px;align-items:center;margin:4px 0}\n      .ui-label{font-size:12px;color:#374151}\n      .ui-input{width:100%;padding:6px 8px;border:1px solid #e5e7eb;border-radius:6px}\n      .ui-btn{display:inline-block;border:1px solid #d1d5db;border-radius:6px;padding:6px 10px;margin:3px 4px;background:#f9fafb}\n      .muted{color:#6b7280}\n    </style>\n    \n</head><body>\n<div class='ui-wrap'>\n<div class='ui-title'>LLM UI‑View · goal=Трафик</div>\n<div class='ui-note muted'>visible nodes scanned: 0, ignored search widgets: 0</div>\n<div class='ui-grid'>\n<section class='ui-block' data-block='tabs'><h3>Objective / Tabs</h3>\n<div class='muted'>—</div>\n</section>\n<section class='ui-block' data-block='primary'><h3>Primary buttons</h3>\n<div class='muted'>—</div>\n</section>\n<section class='ui-block' data-block='buttons'><h3>Buttons</h3>\n<div class='muted'>—</div>\n</section>\n<section class='ui-block' data-block='inputs'><h3>Inputs</h3>\n<div class='muted'>—</div>\n</section>\n</div></div></body></html>\n```",
  "LLM": [
    {
      "type": "wait_dom_stable",
      "ms": 1000
    }
  ],
  "meta": {
    "batch": 4,
    "kind": "next_steps",
    "run_id": "run_42410b71_1756975895"
  }
}